# 继续下一关 - Roguelike版本设计文档

## 🎮 核心玩法

### 游戏模式
- **类型**: Roguelike塔防RPG
- **时长**: 3天(现实30分钟)一局
- **节奏**: 每10分钟一次怪物突袭,难度递增

### 核心机制
1. **角色移动** - 玩家控制角色在世界地图上移动
2. **自动战斗** - 装备的武器自动攻击附近敌人
3. **炮台系统** - 炮台作为道具,可放置/收纳
4. **装备系统** - 6个稀有度的武器、装备、炮台
5. **词条系统** - Boss掉落增强属性的词条

## 🗺️ 世界地图

### 地图大小
- 3000x3000像素的大地图
- 摄像机跟随玩家移动
- 迷你地图显示全局

### 特殊地形
1. **雪山** - 减速效果,冰系怪物
2. **火山** - 持续伤害,火系怪物
3. **城堡** - 玩家基地,需要防守
4. **森林** - 隐蔽区域,可能遭遇伏击
5. **沙漠** - 视野受限,沙尘暴
6. **沼泽** - 毒性区域,持续掉血

### 事件分布
- **小型事件** (60%): 小怪群、宝箱、资源点
- **中型事件** (30%): 怪物营地、精英怪、特殊商店
- **大型事件** (10%): Boss战、稀有宝箱、神秘商人

## 👤 角色系统

### 基础属性
- **生命值**: 基础100,装备加成
- **移动速度**: 基础150像素/秒
- **攻击力**: 武器基础+装备加成
- **防御力**: 装备+词条加成
- **暴击率**: 基础5%
- **暴击伤害**: 基础150%

### 装备槽位
1. **主武器** - 剑/枪/炮
2. **副武器** - 盾/法杖
3. **防具** - 头盔/胸甲/护腿
4. **饰品** - 戒指/项链/护符

## ⚔️ 武器系统

### 武器类型
1. **剑** - 近战,高伤害,范围小
   - 攻击范围: 80像素
   - 攻击速度: 1.5次/秒
   - 特性: 可击退敌人

2. **枪** - 远程,中等伤害,直线攻击
   - 攻击范围: 300像素
   - 攻击速度: 2次/秒
   - 特性: 穿透敌人

3. **盾** - 防御,低伤害,可格挡
   - 攻击范围: 60像素
   - 攻击速度: 1次/秒
   - 特性: 格挡伤害,反弹

4. **炮** - 远程,高伤害,范围攻击
   - 攻击范围: 250像素
   - 攻击速度: 0.8次/秒
   - 特性: AOE伤害

5. **法杖** - 魔法,特殊效果
   - 攻击范围: 200像素
   - 攻击速度: 1.2次/秒
   - 特性: 元素效果(火/冰/雷)

### 自动攻击逻辑
- 自动锁定范围内最近敌人
- 优先攻击血量最低敌人
- 支持手动切换目标

## 🗃️ 道具系统

### 稀有度等级
1. **白色** (普通) - 60%掉率
2. **绿色** (优秀) - 25%掉率
3. **蓝色** (稀有) - 10%掉率
4. **紫色** (史诗) - 4%掉率
5. **金色** (传说) - 0.9%掉率
6. **红色** (神话) - 0.1%掉率

### 炮台道具
- 可放置在地图任意位置
- 可随时收纳回背包
- 不同稀有度有不同属性加成
- 放置后自动攻击范围内敌人

### 背包系统
- 初始容量: 20格
- 可通过升级扩展
- 支持快速装备/丢弃

## 📊 词条系统

### 元素属性系统

#### 八大元素
1. **木** (Wood) - 生命、恢复
   - 特性: 持续治疗、毒素伤害
   - 克制: 土(木克土)
   - 被克: 金(金克木)

2. **水** (Water) - 流动、控制
   - 特性: 减速、冰冻、击退
   - 克制: 火(水克火)
   - 被克: 土(土克水)

3. **火** (Fire) - 爆发、燃烧
   - 特性: 持续燃烧、范围伤害
   - 克制: 金(火克金)
   - 被克: 水(水克火)

4. **土** (Earth) - 防御、稳固
   - 特性: 护盾、减伤、定身
   - 克制: 水(土克水)
   - 被克: 木(木克土)

5. **雷** (Thunder) - 速度、穿透
   - 特性: 连锁闪电、麻痹、破甲
   - 克制: 风(雷克风)
   - 被克: 土(土克雷)

6. **风** (Wind) - 灵活、范围
   - 特性: 击退、加速、范围攻击
   - 克制: 光(风克光)
   - 被克: 雷(雷克风)

7. **光** (Light) - 神圣、净化
   - 特性: 真实伤害、驱散、致盲
   - 克制: 暗(光克暗)
   - 被克: 风(风克光)

8. **暗** (Dark) - 诅咒、吸血
   - 特性: 吸血、诅咒、腐蚀
   - 克制: 光(暗克光,互克)
   - 被克: 光(光克暗,互克)

#### 元素攻击力词条
- 木属性攻击力 +X%
- 水属性攻击力 +X%
- 火属性攻击力 +X%
- 土属性攻击力 +X%
- 雷属性攻击力 +X%
- 风属性攻击力 +X%
- 光属性攻击力 +X%
- 暗属性攻击力 +X%

#### 元素抗性词条
- 木属性抗性 +X%
- 水属性抗性 +X%
- 火属性抗性 +X%
- 土属性抗性 +X%
- 雷属性抗性 +X%
- 风属性抗性 +X%
- 光属性抗性 +X%
- 暗属性抗性 +X%

### 武器类型系统

#### 攻击类型
1. **斩击** (Slash)
   - 武器: 剑、刀、斧
   - 特性: 高暴击、流血效果
   - 强效: 软甲敌人(史莱姆、狼)
   - 弱效: 重甲敌人(骷髅、石头人)

2. **打击** (Blunt)
   - 武器: 锤、棍、盾
   - 特性: 击晕、破盾、高击退
   - 强效: 重甲敌人(骷髅、石头人)
   - 弱效: 软甲敌人(史莱姆、幽灵)

3. **戳击** (Pierce)
   - 武器: 枪、矛、弓
   - 特性: 穿透、高单体伤害
   - 强效: 中甲敌人(哥布林、兽人)
   - 弱效: 重甲敌人(石头人、龙)

4. **魔法** (Magic)
   - 武器: 法杖、魔导书
   - 特性: 元素伤害、范围攻击
   - 强效: 物理抗性敌人(幽灵、元素)
   - 弱效: 魔法抗性敌人(魔像、龙)

5. **射击** (Ranged)
   - 武器: 弓、弩、枪械
   - 特性: 远程、高精准
   - 强效: 飞行敌人(鸟、龙)
   - 弱效: 高闪避敌人(幽灵、忍者)

6. **爆炸** (Explosion)
   - 武器: 炸弹、炮台
   - 特性: AOE、破甲
   - 强效: 群体敌人、建筑
   - 弱效: 单体高血量敌人

#### 武器类型词条
- 斩击伤害 +X%
- 打击伤害 +X%
- 戳击伤害 +X%
- 魔法伤害 +X%
- 射击伤害 +X%
- 爆炸伤害 +X%

### 词条类型

#### 1. **基础属性类**
- 攻击力 +X%
- 防御力 +X%
- 生命值 +X%
- 移动速度 +X%

#### 2. **战斗属性类**
- 暴击率 +X%
- 暴击伤害 +X%
- 攻击速度 +X%
- 冷却缩减 +X%
- 生命偷取 +X%
- 伤害反弹 +X%

#### 3. **元素属性类**
- [元素]属性攻击力 +X%
- [元素]属性抗性 +X%
- 全元素攻击力 +X%
- 全元素抗性 +X%
- 元素伤害加成 +X%

#### 4. **武器类型类**
- [类型]伤害 +X%
- 全武器伤害 +X%
- 武器切换速度 +X%
- 攻击范围 +X%

#### 5. **特殊效果类**
- 击退效果 +X%
- 眩晕几率 +X%
- 流血伤害 +X/秒
- 燃烧伤害 +X/秒
- 中毒伤害 +X/秒
- 冰冻几率 +X%

#### 6. **资源类**
- 金币掉落 +X%
- 经验获取 +X%
- 掉落率 +X%
- 背包容量 +X

### 怪物抗性系统

#### 抗性类型
1. **物理抗性**
   - 斩击抗性: 减少斩击伤害
   - 打击抗性: 减少打击伤害
   - 戳击抗性: 减少戳击伤害

2. **元素抗性**
   - 木抗性: 减少木属性伤害
   - 水抗性: 减少水属性伤害
   - 火抗性: 减少火属性伤害
   - 土抗性: 减少土属性伤害
   - 雷抗性: 减少雷属性伤害
   - 风抗性: 减少风属性伤害
   - 光抗性: 减少光属性伤害
   - 暗抗性: 减少暗属性伤害

3. **特殊抗性**
   - 魔法抗性: 减少所有魔法伤害
   - 真实伤害抗性: 减少真实伤害
   - AOE抗性: 减少范围伤害

#### 怪物抗性示例

**史莱姆** (软甲)
- 斩击抗性: -30% (易受斩击)
- 打击抗性: +50% (抗打击)
- 戳击抗性: 0%
- 火抗性: -50% (易燃)

**骷髅** (重甲)
- 斩击抗性: +40% (抗斩击)
- 打击抗性: -30% (易受打击)
- 戳击抗性: +20%
- 光抗性: -50% (神圣克制)

**石头人** (超重甲)
- 斩击抗性: +60%
- 打击抗性: +60%
- 戳击抗性: +60%
- 魔法抗性: -40% (魔法克制)

**幽灵** (虚无)
- 物理抗性: +80% (几乎免疫物理)
- 魔法抗性: -30% (魔法克制)
- 光抗性: -50% (神圣克制)

**龙** (龙鳞)
- 物理抗性: +30%
- 魔法抗性: +30%
- 火抗性: +80% (免疫火焰)
- 雷抗性: -40% (雷属性弱点)

### 伤害计算公式

```
最终伤害 = 基础伤害 
          × (1 + 武器类型伤害加成%)
          × (1 + 元素伤害加成%)
          × (1 - 怪物对应抗性%)
          × 暴击倍率
          × 其他加成
```

**示例计算:**
- 基础伤害: 100
- 武器类型: 斩击 +20%
- 元素: 火 +30%
- 怪物: 史莱姆(斩击-30%, 火-50%)
- 暴击: 150%

```
最终伤害 = 100 × 1.2 × 1.3 × (1-(-0.3)) × (1-(-0.5)) × 1.5
        = 100 × 1.2 × 1.3 × 1.3 × 1.5 × 1.5
        = 456.3
```

### 词条获取
- Boss击杀必定掉落1-3个词条
- 稀有度越高,词条数值越好
- 词条可镶嵌到装备上
- 同类词条可叠加

## ⏰ 时间系统

### 游戏时间
- **1天** = 现实10分钟
- **总时长** = 3天 = 30分钟

### 时间事件
- **白天** (0-7分钟): 探索、收集资源
- **黄昏** (7-8分钟): 警告提示
- **夜晚** (8-10分钟): 怪物突袭

### 突袭难度
- **第1天**: 100只小怪 + 1个精英
- **第2天**: 200只小怪 + 3个精英 + 1个小Boss
- **第3天**: 300只小怪 + 5个精英 + 最终Boss魔王

## 👹 怪物系统

### 普通怪物
- **史莱姆**: 低血量,低伤害
- **哥布林**: 中等属性,群体出现
- **骷髅**: 高攻击,低防御
- **狼**: 快速移动,群体攻击

### 精英怪物
- **精英哥布林**: 召唤小怪
- **精英骷髅**: 高伤害,范围攻击
- **精英狼王**: 召唤狼群,咆哮眩晕

### Boss怪物
- **小Boss** (中型事件):
  - 哥布林王: 召唤哥布林,投掷炸弹
  - 骷髅王: 召唤骷髅,骨盾防御
  - 狼王: 召唤狼群,狂暴模式

- **最终Boss** (魔王):
  - 多阶段战斗
  - 技能1: 召唤小怪
  - 技能2: 范围攻击
  - 技能3: 全屏技能
  - 技能4: 狂暴模式(血量<30%)

## 🏰 城堡防守

### 城堡机制
- 城堡有独立血量
- 怪物会优先攻击城堡
- 玩家需要保护城堡
- 城堡被摧毁=游戏失败

### 防守策略
- 在城堡周围放置炮台
- 亲自击杀靠近的敌人
- 利用特殊地形优势
- 合理分配资源升级

## 🎯 游戏目标

### 胜利条件
- 存活3天
- 击败最终Boss魔王
- 保护城堡不被摧毁

### 失败条件
- 角色死亡
- 城堡被摧毁

### 评分系统
- 存活时间
- 击杀数量
- 收集装备
- 完成事件
- 最终得分

## 🔄 进度系统

### 永久解锁
- 新角色皮肤
- 初始装备
- 特殊词条
- 成就系统

### 单局进度
- 等级提升
- 装备收集
- 词条镶嵌
- 技能解锁

---

## 实现优先级

### Phase 1: 核心系统
1. ✅ 角色移动和控制
2. ✅ 武器自动攻击
3. ✅ 基础怪物AI
4. ✅ 碰撞检测

### Phase 2: 道具系统
1. ✅ 背包系统
2. ✅ 装备系统
3. ✅ 炮台放置/收纳
4. ✅ 掉落系统

### Phase 3: 世界系统
1. ✅ 大地图生成
2. ✅ 摄像机跟随
3. ✅ 特殊地形
4. ✅ 事件系统

### Phase 4: 时间系统
1. ✅ 时间流逝
2. ✅ 怪物突袭
3. ✅ 难度递增
4. ✅ Boss战

### Phase 5: 完善系统
1. ✅ 词条系统
2. ✅ 稀有度系统
3. ✅ 成就系统
4. ✅ UI优化
